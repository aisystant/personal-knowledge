# Персональный Репозиторий знаний

Хранилище персонального контента в виде чанков (до 10 000 символов).

## Структура

- `club/` — посты и комментарии из Клуба
- `lms/` — комментарии под ДЗ стажеров
- `manual/` — ручные добавления (заметки, рефлексии, проекты)
- `external/` — контент из других репозиториев
- `metadata/` — индексы и метаданные
- `scripts/` — утилиты для работы с репозиторием

## Использование

### Автоматический импорт

Импорт происходит автоматически каждый день через GitHub Actions.

### Ручной импорт

```bash
# Из Клуба
python scripts/import_from_club.py --from-date 2025-01-01

# Из LMS
python scripts/import_from_lms.py --student-id all

# Из других репо
python scripts/import_from_repo.py --repo ecosystem-development
```

### Ручное добавление

Создайте новый markdown файл в папке `manual/` с корректными метаданными.

### Ручное редактирование

При редактировании чанка добавьте запись в историю изменений:

```bash
# Автоматически
python scripts/add_changelog_entry.py --file club/posts/2025-01-11_post.md --message "Исправлены опечатки"

# Или вручную
# Откройте файл и добавьте запись в раздел "История изменений"
```

### Валидация

```bash
python scripts/validate_chunks.py
```

## Формат чанка

См. `config/metadata-schema.yaml`

**Важные особенности:**
- Максимальный размер контента: **10 000 символов** (без учёта истории изменений)
- Раздел **"История изменений"** находится в конце файла между маркерами `<!-- EMBEDDINGS_EXCLUDE_START -->` и `<!-- EMBEDDINGS_EXCLUDE_END -->`
- Этот раздел **не индексируется** и не попадает в эмбеддинги
- История пишется в обратном хронологическом порядке (новые записи сверху)

## Интеграция с Индексатором знаний

Этот репозиторий является источником данных для **Индексатора знаний (1.2)**,
который создает эмбеддинги и сохраняет их в **Базу данных эмбеддингов (2.4)**.

## Редактирование

Все файлы можно редактировать вручную. После коммита изменения автоматически
подхватываются Индексатором знаний.

**При ручном редактировании:**
1. Отредактируйте контент чанка
2. Добавьте запись в раздел "История изменений"
3. Обновите поле `updated` в frontmatter
4. Закоммитьте изменения

**Автоматическое добавление в историю:**
```bash
python scripts/add_changelog_entry.py --file path/to/chunk.md --message "Описание изменения"
```

## Связь с общей архитектурой

Этот Репозиторий знаний (2.3) является частью общей архитектуры ИТ-платформы:

```
Пользователь
    ↓
Интерфейсы (LMS, Клуб, Telegram)
    ↓
Репозиторий знаний (2.3) ← ВЫ ЗДЕСЬ
    ↓
Индексатор знаний (1.2)
    ↓
База данных эмбеддингов (2.4)
    ↓
ИИ-системы (ДЗ-чекер, Проводник, и др.)
    ↓
Интерфейсы
    ↓
Пользователь
```
